// Copyright (C) 2016 Peter Graves <gnooth@gmail.com>

// This program is free software: you can redistribute it and/or modify
// it under the terms of the GNU General Public License as published by
// the Free Software Foundation, either version 3 of the License, or
// (at your option) any later version.

// This program is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU General Public License for more details.

// You should have received a copy of the GNU General Public License
// along with this program.  If not, see <http://www.gnu.org/licenses/>.

require-system-file test-framework

LANGUAGE: feline

CONTEXT: feline forth ;
CURRENT: feline

test: test1 ( -- )
    1 fixnum? check-t
    2 fixnum? check-t
    3 fixnum? check-t
    1 2 + 3 = check-t
    1 2 + fixnum? check-t
;

test1

test: test2 ( -- )
    -1 fixnum? check-t
    -2 fixnum? check-t
    -3 fixnum? check-t
    -1 -2 + -3 = check-t
;

test2

test: test3 ( -- )
    0 fixnum? check-t
    0 0= check-t
    1 0= check-false
    -1 0= check-false
    1 -1 + 0= check-t
    4 -4 + 0= check-t
;

test3

// fixnum<
test: test4 ( -- )
    1 2 fixnum< check-t
    2 1 fixnum< check-false
    -2 -1 fixnum< check-t
    -1 -2 fixnum< check-false
    -2 1 fixnum< check-t
    1 -2 fixnum< check-false
    1 2 < check-t
    2 1 fixnum>= check-t
    2 1 >= check-t
;

test4

test: test5 ( -- )
    1 2 fixnum- -1 = check-t
    1 2 - -1 = check-t
;

test5

test: test6 ( -- )
    2 3 fixnum* 6 = check-t
    2 3 * 6 = check-t
;

test6

test: test7 ( -- )
    8 3 fixnum/i 2 = check-t
    8 3 / 2 = check-t
    -8 3 fixnum/i -2 = check-t
    -8 3 / -2 = check-t
;

test7

test: test8 ( -- )
    7 3 fixnum-mod 1 = check-t
    7 3 mod 1 = check-t
    -7 3 fixnum-mod -1 = check-t
    -7 3 mod -1 = check-t
;

test8

// fixnum-bitand, bitand
test: test9 ( -- )
    15 7 bitand 7 = check-t
    15 $f0 bitand 0 = check-t
    3 1 and 1 = check-t
;

test9

// fixnum+
test: test10 ( -- )
    42 87 fixnum+ 129 = check-t
    -42 87 fixnum+ 45 = check-t
    42 -87 fixnum+ -45 = check-t
    -42 -87 fixnum+ -129 = check-t
;

test10

test: test11 ( -- )
    MOST_POSITIVE_FIXNUM tag-fixnum most-positive-fixnum = check-t
    MOST_NEGATIVE_FIXNUM tag-fixnum most-negative-fixnum = check-t
    most-positive-fixnum untag-fixnum MOST_POSITIVE_FIXNUM = check-t
    most-negative-fixnum untag-fixnum MOST_NEGATIVE_FIXNUM = check-t
;

test11

empty

?cr .( Reached end of fixnum-tests )
